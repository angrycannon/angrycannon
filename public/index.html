<!DOCTYPE HTML>
<html>
<body>

<canvas id="myCanvas" width=300 height=410>your browser does not support the canvas tag </canvas>

<script type="text/javascript">
	
const canvasw = 300;
const canvash = 410;
const paddlew = 50;
const paddleh = 10;

var canvas = document.getElementById('myCanvas');
var ctx = canvas.getContext('2d');
//var ball = new Ball(100,100,10,10, "#fff");
var ball = makeBall();
var paddles = [new Paddle(10,0, "#eee"), 
		new Paddle(canvasw-paddlew-20, canvash-paddleh, "#ddd")];
document.onLoad = updateCanvas();

function Ball(dxi, dyi, vxi, vyi, color) {
    this.dx = dxi;
    this.dy = dyi;
    this.vx = vxi;
    this.vy = vyi;
    this.color = color;
}

function Paddle(dxi, dyi, color) {
		this.dx = dxi;
		this.dy = dyi;
		this.color = color;
}

Paddle.prototype.draw = function() {
		ctx.fillStyle = this.color;
		ctx.fillRect(this.dx, this.dy, paddlew, paddleh);
}

Ball.prototype.step = function() { with(this) {
    dx += vx;
    dy += vy;
    
    // Check bounds.
    if (dx < 0) {
        dx = 0;
        vx = -vx;
    }
    if (dy < 0) {
        dy = 0;
        vy = -vy;
    }
    if (dx > canvasw) {
        dx = canvasw;
        vx = -vx;
    }
    if (dy > canvash) {
        dy = canvash;
        vy = -vy;
    }
} }

Ball.prototype.draw = function() { with(this) {
    ctx.fillStyle = this.color;
		fillCircle(dx, dy, 10);
} }

function fillCircle(dx, dy, radius) {
		ctx.beginPath();
		ctx.arc(dx, dy, radius, 0, Math.PI*2, true);
		ctx.closePath();
		ctx.fill();
}

function rand(n) {
    return Math.floor( Math.random()*n);
}

function makeBall() {
    var rdx = rand(canvasw);
    var rdy = rand(canvash);
    var vx = 2;
    var vy = 2;
    var rcolor = 'rgb('+rand(256)+', '+rand(256)+', '+rand(256)+')';
    return new Ball(rdx, rdy, vx, vy, "#fff");
}
    
var len = paddles.length;

function updateCanvas() {
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvasw, canvash);
		// ball.draw is undefined before this point but defined after it??????
		for (i = 0; i < len; i++) {
			paddles[i].draw();
			ball.draw();
		}
    for (i = 0; i < len; i++)
        ball.step();
    setTimeout('updateCanvas()', 10);
    return;
}

</script>

</body>
</html>
